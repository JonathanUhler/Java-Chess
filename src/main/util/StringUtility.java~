package util;


import java.util.Map;
import java.util.Arrays;
import java.util.stream.Collectors;


public class StringUtility {

	public static String coordinateToString(Coordinate c) {
		char column = (c.isValidTile()) ? (char)('a' + c.getX()) : ('?');
		String row = (c.isValidTile()) ? ((c.getY() + 1) + "") : "?";
		return column + "" + row;
	}


	public static Coordinate stringToCoordinate(String raw) {
		if (raw.length() != 2)
			return null;

		char columnChar = raw.charAt(0);
		char rowChar = raw.charAt(1);

		if (!Character.isDigit(rowChar))
			return null;

		int column = columnChar - 'a';
		int row = Character.getNumericValue(rowChar) - 1;
		
		return new Coordinate(column, row);
	}
	

	// Source: https://stackoverflow.com/questions/26485964/how-to-convert-string-into-hashmap-in-java
	public static Map<String, String> stringToMap(String raw) {
		try {
			String cleaned = raw.replaceAll("\"", "");
			cleaned = cleaned.replaceAll("[{}]", " ");
			Map<String, String> map = Arrays.stream(cleaned.split(","))
									  .map(s -> s.split(":", 2))
									  .collect(Collectors.toMap(s -> s[0].trim(), s -> s[1].trim()));
			return map;
		}
		catch (Exception e) {
			Log.stdlog(Log.ERROR, "StringUtility", "stringToMap failed");
			Log.stdlog(Log.ERROR, "StringUtility", "\t" + e);
			return null;
		}
	}


	public static String mapToString(Map<String, String> map) {
		try {
			String raw = map
				.entrySet()
				.stream()
				.map(e -> "\"" + e.getKey() + "\":\"" + e.getValue() + "\"")
				.collect(Collectors.joining(","));
			raw = "{" + raw + "}";
			return raw;
		}
		catch (Exception e) {
			Log.stdlog(Log.ERROR, "StringUtility", "stringToMap failed");
			Log.stdlog(Log.ERROR, "StringUtility", "\t" + e);
			return null;
		}
	}

}
